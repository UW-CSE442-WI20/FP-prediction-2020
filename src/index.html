<!DOCTYPE html>

<html>
<head>
	<meta charset="UTF-8">
	<title>Prediction 2020</title>
	<link rel="stylesheet" type="text/css" href="./index.css"/>
</head>
<body>
	<div id="graphic">
		<div id="sections">
			<section class="step">
				<div class="title"> </div>
			</section>
			<section class="step">
				<div class="title">2000</div>
				<b>George W. Bush vs. Al Gore</b><br> Blurb about the 2000 election...
			</section>
			<section class="step">
				<div class="title">2004</div>
				<b>George W. Bush vs. John Kerry</b><br> Blurb about the 2004 election...
			</section>
			<section class="step">
				<div class="title">2008</div>
				<b>Barack Obama vs. John McCain</b><br> Blurb about the 2008 election...
			</section>
			<section class="step">
				<div class="title">2012</div>
				<b>Barack Obama vs. Mitt Romney</b><br> Blurb about the 2012 election...
			</section>
			<section class="step">
				<div class="title">2016</div>
				<b>Donald Trump vs. Hillary Clinton</b><br> Blurb about the 2016 election...
			</section>
			<section class="step">
				<div class="title">2016 Swing States</div>
				Blurb about states that flipped in 2016...
			</section>
			<section class="step">
				<div class="title">Florida</div>
				2016 county election data for Florida along with polling data for 2020...
			</section>
			<section class="step">
				<div class="title">Iowa</div>
				2016 county election data for Iowa along with polling data for 2020...
			</section>
			<section class="step">
				<div class="title">Michigan</div>
				2016 county election data for Michigan along with polling data for 2020...
			</section>
			<section class="step">
				<div class="title">Ohio</div>
				2016 county election data for Ohio along with polling data for 2020...
			</section>
			<section class="step">
				<div class="title">Pennsylvania</div>
				2016 county election data for Pennsylvania along with polling data for 2020...
			</section>
			<section class="step">
				<div class="title">Wisconsin</div>
				2016 county election data for Wisconsin along with polling data for 2020...
			</section>
			<section class="step">
				<div class="title">Predictions</div>
				Our predictions for the outcome of the 2020 election...
			</section>
		</div>
		<div id="vis">
		</div>
		<div id="extra-space">
		</div>
	</div>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
	<script type="text/javascript" src="https://d3js.org/topojson.v3.min.js"></script>
	<script src="./index.js" charset="utf-8"></script>
</body>
</html>








<!-- POLLING LINE CHART DATA -->
<!-- Data is from fivethirtyeight -->
<!-- Taken from https://bl.ocks.org/larsenmtl/e3b8b7c2ca4787f77d78f58d41c3da91 -->
<!-- <!DOCTYPE html>
<html>

<head>
  <script data-require="d3@3.5.3" data-semver="3.5.3" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.js"></script>
  <style>
    body {
      font: 10px sans-serif;
    }
    
    .axis path,
    .axis line {
      fill: none;
      stroke: #000;
      shape-rendering: crispEdges;
    }
    
    .x.axis path {
      display: none;
    }
    
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 1.5px;
    }
  </style>
</head>

<body>
  <script>
var flData = "date	Sanders	Biden\n\
20190304	8.0	18.5\n\
20190321	13.0	37.0\n\
20190508	16.0	39.0\n\
20190519	11.6	39.2\n\
20190529	18.3	34.4\n\
20190611	16.0	32.0\n\
20190617	17.0	37.0\n\
20190623	8.0	47.4\n\
20190915	14.4	34.0\n\
20190918	8.0	34.666666666666664\n\
20191026	13.0	27.0\n\
20200112	15.5	41.5\n\
20200123	19.0	35.0\n\
20200128	9.4	41.3\n\
20200213	10.4	25.9\n\
20200218	13.0	20.0\n\
20200219	11.4	26.5\n\
20200221	18.0	22.0\n\
20200222	16.7	24.6\n\
20200226	13.0	33.8\n\
20200304	11.9	61.2\n\
";


var ohData = "date	Sanders	Biden\n\
20190529	18.7	28.5\n\
20190722	14.0	31.0\n\
20191002	26.6	29.2\n\
20191007	13.0	32.0\n\
20200120	20.8	32.1\n\
";


var iaData = "date	Sanders	Biden\n\
20181211	13.0	30.0\n\
20181213	19.0	32.0\n\
20181217	20.0	20.0\n\
20190202	12.59	27.295\n\
20190306	25.0	27.0\n\
20190315	15.0	29.0\n\
20190324	20.55	25.15\n\
20190409	16.0	27.0\n\
20190418	19.0	19.0\n\
20190502	13.7	34.9\n\
20190519	24.0	24.0\n\
20190605	16.0	24.0\n\
20190612	22.0	30.0\n\
20190620	18.0	27.0\n\
20190701	10.5	20.5\n\
20190704	16.0	16.0\n\
20190718	19.0	24.0\n\
20190725	10.9	22.9\n\
20190804	9.0	28.0\n\
20190811	17.0	17.0\n\
20190904	26.0	29.0\n\
20190916	9.0	25.0\n\
20190917	16.0	16.0\n\
20190918	11.0	20.0\n\
20191010	5.0	21.5\n\
20191011	21.0	22.0\n\
20191016	12.5	22.8\n\
20191018	9.0	17.6\n\
20191022	18.0	12.0\n\
20191030	19.0	17.0\n\
20191105	17.0	15.0\n\
20191106	14.0	13.0\n\
20191110	18.1	15.3\n\
20191111	13.0	19.0\n\
20191113	18.5	18.5\n\
20191119	18.0	12.0\n\
20191210	21.7	23.3\n\
20191216	21.0	15.0\n\
20200103	23.0	23.0\n\
20200108	20.0	15.0\n\
20200112	21.0	26.0\n\
20200117	10.3	23.3\n\
20200118	14.0	24.0\n\
20200121	24.0	17.0\n\
20200123	24.0	21.0\n\
20200126	26.35	21.575\n\
20200127	23.0	22.25\n\
20200128	18.0	20.0\n\
20200129	28.0	15.0\n\
20200130	26.666666666666668	26.0\n\
20200202	24.75	19.5\n\
";


var miData = "date	Sanders	Biden\n\
20190310	23.3	39.6\n\
20190510	16.0	37.0\n\
20190529	18.3	27.3\n\
20190717	16.0	35.0\n\
20190924	12.0	27.0\n\
20191015	15.0	19.0\n\
20191025	17.0	30.0\n\
20191103	27.6	33.5\n\
20200120	21.6	27.0\n\
20200220	25.0	16.0\n\
20200302	22.5	29.2\n\
";


var paData = "date	Sanders	Biden\n\
20190328	20.4	39.0\n\
20190410	16.0	28.0\n\
20190514	13.0	39.0\n\
20190529	14.9	46.0\n\
20190804	12.0	28.0\n\
20191006	6.0	17.0\n\
20191015	14.0	27.0\n\
20191025	14.0	28.0\n\
20191027	12.0	30.0\n\
20200120	20.5	31.3\n\
20200126	15.0	22.0\n\
20200220	25.0	20.0\n\
";


var wiData = "date	Sanders	Biden\n\
20190317	38.9	23.5\n\
20190418	20.0	24.0\n\
20190529	13.1	28.3\n\
20190704	19.0	18.0\n\
20190811	24.0	20.0\n\
20190829	20.0	28.0\n\
20191002	21.0	19.5\n\
20191015	10.0	17.0\n\
20191017	17.0	31.0\n\
20191026	20.0	23.0\n\
20191117	17.0	30.0\n\
20191208	19.0	23.0\n\
20200108	21.0	23.0\n\
20200112	19.0	23.0\n\
20200120	28.4	21.8\n\
20200220	29.8	12.9\n\
20200223	29.0	15.0\n\
";

var LEGEND_LOCATION = -90; // the x coordinate of the legend

var data = d3.tsv.parse(miData);

    var margin = {
        top: 20,
        right: 80,
        bottom: 30,
        left: 50
      },
      width = 900 - margin.left - margin.right,
      height = 500 - margin.top - margin.bottom;

    var parseDate = d3.time.format("%Y%m%d").parse;

    var x = d3.time.scale()
      .range([0, width]);

    var y = d3.scale.linear()
      .range([height, 0]);

	var color = d3.scale.category10()
	.range(['#00AA61', '#7E50DB']); // COLORS: sanders then biden

    var xAxis = d3.svg.axis()
      .scale(x)
      .orient("bottom");

    var yAxis = d3.svg.axis()
      .scale(y)
      .orient("left");

    var line = d3.svg.line()
      .interpolate("basis")
      .x(function(d) {
        return x(d.date);
      })
      .y(function(d) {
        return y(d.temperature);
      });

    var svg = d3.select("body").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    

    color.domain(d3.keys(data[0]).filter(function(key) {
      return key !== "date";
    }));

    data.forEach(function(d) {
      d.date = parseDate(d.date);
    });

    var cities = color.domain().map(function(name) {
      return {
        name: name,
        values: data.map(function(d) {
          return {
            date: d.date,
            temperature: +d[name]
          };
        })
      };
    });

    x.domain(d3.extent(data, function(d) {
      return d.date;
    }));

    y.domain([
      d3.min(cities, function(c) {
        return d3.min(c.values, function(v) {
          return v.temperature;
        });
      }),
      d3.max(cities, function(c) {
        return d3.max(c.values, function(v) {
          return v.temperature;
        });
      })
    ]);

    var legend = svg.selectAll('g')
      .data(cities)
      .enter()
      .append('g')
      .attr('class', 'legend');

    legend.append('rect')
      .attr('x', width + LEGEND_LOCATION)
      .attr('y', function(d, i) {
        return i * 20;
      })
      .attr('width', 10)
      .attr('height', 10)
      .style('fill', function(d) {
        return color(d.name);
      });

    legend.append('text')
      .attr('x', width  + (LEGEND_LOCATION + 15))
      .attr('y', function(d, i) {
        return (i * 20) + 9;
      })
      .text(function(d) {
        return d.name;
      });

    svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

    svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
      .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Polling Percent");

    var city = svg.selectAll(".city")
      .data(cities)
      .enter().append("g")
      .attr("class", "city");

    city.append("path")
      .attr("class", "line")
      .attr("d", function(d) {
        return line(d.values);
      })
      .style("stroke", function(d) {
        return color(d.name);
      });

    city.append("text")
      .datum(function(d) {
        return {
          name: d.name,
          value: d.values[d.values.length - 1]
        };
      })
      .attr("transform", function(d) {
        return "translate(" + x(d.value.date) + "," + y(d.value.temperature) + ")";
      })
      .attr("x", 3)
      .attr("dy", ".35em")
      .text(function(d) {
        return d.name;
      });

    var mouseG = svg.append("g")
      .attr("class", "mouse-over-effects");

    mouseG.append("path") // this is the black vertical line to follow mouse
      .attr("class", "mouse-line")
      .style("stroke", "black")
      .style("stroke-width", "1px")
      .style("opacity", "0");
      
    var lines = document.getElementsByClassName('line');

    var mousePerLine = mouseG.selectAll('.mouse-per-line')
      .data(cities)
      .enter()
      .append("g")
      .attr("class", "mouse-per-line");

    mousePerLine.append("circle")
      .attr("r", 7)
      .style("stroke", function(d) {
        return color(d.name);
      })
      .style("fill", "none")
      .style("stroke-width", "1px")
      .style("opacity", "0");

    mousePerLine.append("text")
      .attr("transform", "translate(10,3)");

    mouseG.append('svg:rect') // append a rect to catch mouse movements on canvas
      .attr('width', width) // can't catch mouse events on a g element
      .attr('height', height)
      .attr('fill', 'none')
      .attr('pointer-events', 'all')
      .on('mouseout', function() { // on mouse out hide line, circles and text
        d3.select(".mouse-line")
          .style("opacity", "0");
        d3.selectAll(".mouse-per-line circle")
          .style("opacity", "0");
        d3.selectAll(".mouse-per-line text")
          .style("opacity", "0");
      })
      .on('mouseover', function() { // on mouse in show line, circles and text
        d3.select(".mouse-line")
          .style("opacity", "1");
        d3.selectAll(".mouse-per-line circle")
          .style("opacity", "1");
        d3.selectAll(".mouse-per-line text")
          .style("opacity", "1");
      })
      .on('mousemove', function() { // mouse moving over canvas
        var mouse = d3.mouse(this);
        d3.select(".mouse-line")
          .attr("d", function() {
            var d = "M" + mouse[0] + "," + height;
            d += " " + mouse[0] + "," + 0;
            return d;
          });

        d3.selectAll(".mouse-per-line")
          .attr("transform", function(d, i) {
            console.log(width/mouse[0])
            var xDate = x.invert(mouse[0]),
                bisect = d3.bisector(function(d) { return d.date; }).right;
                idx = bisect(d.values, xDate);
            
            var beginning = 0,
                end = lines[i].getTotalLength(),
                target = null;

            while (true){
              target = Math.floor((beginning + end) / 2);
              pos = lines[i].getPointAtLength(target);
              if ((target === end || target === beginning) && pos.x !== mouse[0]) {
                  break;
              }
              if (pos.x > mouse[0])      end = target;
              else if (pos.x < mouse[0]) beginning = target;
              else break; //position found
            }
            
            d3.select(this).select('text')
              .text(y.invert(pos.y).toFixed(2));
              
            return "translate(" + mouse[0] + "," + pos.y +")";
          });
      });
      
  </script>
</body>

</html> -->

